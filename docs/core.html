---

title: ihu


keywords: fastai
sidebar: home_sidebar

summary: "Evolve any unitary using solve_ivp."
description: "Evolve any unitary using solve_ivp."
nb_path: "00_core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ihu" class="doc_header"><code>ihu</code><a href="https://github.com/TejasAvinashShetty/ihu/blob/master/ihu/core.py#L14" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ihu</code>(<strong><code>ham_func</code></strong>, <strong><code>u0</code></strong>, <strong><code>evolution_time</code></strong>, <strong><code>no_time_step_for_eval</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>evolves the unitary</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>ham_func : function
    Function which produces the Hamiltonian
    as it appears at time t
    form ham_func(t)
u0 : ndarray
    Unitary at time 0
evolution_time : float
    Evolution time
no_time_step_for_eval : int
    no of time steps for evaluation in the
    final output
**kwargs
    Arbitrary optional keyword arguments.
    w : float
        Defaults to 6.28</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>Bunch object with the following fields defined:
t  : [ndarray, shape (n_points,)]
    Time points.
y  : [ndarray, shape (n, n_points)]
    Values of the solution at t.
sol: [OdeSolution or None]
    Found solution as OdeSolution instance; None if
    dense_output was set to False.
t_events: [list of ndarray or None]
    Contains for each event type a list of arrays at which an event of
    that type event was detected. None if events was None.
nfev: [int]
    Number of evaluations of the right-hand side.
njev: [int]
    Number of evaluations of the Jacobian.
nlu :[int]
    Number of LU decompositions.
status [int]
    Reason for algorithm termination:
    • -1: Integration step failed.
    • 0: The solver successfully reached the end of tspan.
    • 1: A termination event occurred.
message: [string]
    Human-readable description of the termination reason.
success: [bool]
    True if the solver reached the interval end or a
    termination event occurred (status</p>
<blockquote><p>= 0).</p>
</blockquote>
<p>u_series :[ndarray, shape (sqrt(n), sqrt(n), n_points)]
    Values of the solution at t.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Steps:</p>
<ul>
<li>Determines Shape of U0.</li>
<li>Determines Shape of H (at any random time t).</li>
<li>If anyone of U, H are non square exit.</li>
<li>If shapes match proceed else exit.</li>
<li>make sure Output of H is Hermitian 
 (by trying it out at 3 different times)</li>
<li>Initialize inputs T, Nt</li>
<li>Flatten u0 to get y0</li>
<li>calculate dt = T/ Nt</li>
<li>make y_der</li>
<li>evolve y</li>
<li>collect results</li>
<li>y_series to u_series</li>
<li>print messages</li>
<li>return stuff + u_series</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Call syntax</p>
<p>u_series, result = ihu(ham_func, u0, T, no_time_step_for_eval, **kwargs)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10.])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([ 1.        ,  1.09090909,  1.18181818,  1.27272727,  1.36363636,
        1.45454545,  1.54545455,  1.63636364,  1.72727273,  1.81818182,
        1.90909091,  2.        ,  2.09090909,  2.18181818,  2.27272727,
        2.36363636,  2.45454545,  2.54545455,  2.63636364,  2.72727273,
        2.81818182,  2.90909091,  3.        ,  3.09090909,  3.18181818,
        3.27272727,  3.36363636,  3.45454545,  3.54545455,  3.63636364,
        3.72727273,  3.81818182,  3.90909091,  4.        ,  4.09090909,
        4.18181818,  4.27272727,  4.36363636,  4.45454545,  4.54545455,
        4.63636364,  4.72727273,  4.81818182,  4.90909091,  5.        ,
        5.09090909,  5.18181818,  5.27272727,  5.36363636,  5.45454545,
        5.54545455,  5.63636364,  5.72727273,  5.81818182,  5.90909091,
        6.        ,  6.09090909,  6.18181818,  6.27272727,  6.36363636,
        6.45454545,  6.54545455,  6.63636364,  6.72727273,  6.81818182,
        6.90909091,  7.        ,  7.09090909,  7.18181818,  7.27272727,
        7.36363636,  7.45454545,  7.54545455,  7.63636364,  7.72727273,
        7.81818182,  7.90909091,  8.        ,  8.09090909,  8.18181818,
        8.27272727,  8.36363636,  8.45454545,  8.54545455,  8.63636364,
        8.72727273,  8.81818182,  8.90909091,  9.        ,  9.09090909,
        9.18181818,  9.27272727,  9.36363636,  9.45454545,  9.54545455,
        9.63636364,  9.72727273,  9.81818182,  9.90909091, 10.        ])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="y_der" class="doc_header"><code>y_der</code><a href="https://github.com/TejasAvinashShetty/ihu/blob/master/ihu/core.py#L91" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>y_der</code>(<strong><code>t</code></strong>, <strong><code>y</code></strong>, <strong><code>u_shape</code></strong>, <strong><code>ham_func</code></strong>)</p>
</blockquote>
<p>Basically dy/dt</p>
<p>Does some stuff.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>t : float
    Current time value during the integration
y : ndarray
    flattened unitary at the current time</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>dydt : ndarray
    flattened derivative of the unitary</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="check_for_stupidity" class="doc_header"><code>check_for_stupidity</code><a href="https://github.com/TejasAvinashShetty/ihu/blob/master/ihu/core.py#L118" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>check_for_stupidity</code>(<strong><code>ham_func</code></strong>, <strong><code>u0</code></strong>)</p>
</blockquote>
<p>Perform checks for invalid inputs and the lot</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sqrt</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>3.0</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

